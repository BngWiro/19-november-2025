<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <title>Selamat Ulang Tahun, Keisya ðŸ’–</title>
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
:root{ --bg1:#fff9fb; --bg2:#fff0f7; --accent:#b02764; --soft:#ffdfe9; --muted:#6b4459; --glass:rgba(255,255,255,0.94); }
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%}
body{font-family: 'Poppins', sans-serif;background: linear-gradient(160deg,var(--bg1),var(--bg2));color:var(--muted);-webkit-font-smoothing:antialiased}
.page{min-height:100vh;display:flex;flex-direction:column;align-items:center;padding:16px}
.hero{width:100%;max-width:760px;background:var(--glass);border-radius:14px;padding:18px;text-align:center;box-shadow:0 10px 30px rgba(200,120,160,0.06)}
.badge{display:inline-block;background:var(--accent);color:#fff;padding:6px 12px;border-radius:999px;font-weight:600;margin-bottom:10px}
.title{font-family:'Great Vibes',cursive;font-size:36px;color:var(--accent);margin:6px 0}
.title span{font-family:inherit;font-size:14px;color:#7a4566}
.countdown-wrap{margin:10px 0}
.countdown{display:flex;justify-content:center;gap:8px;flex-wrap:wrap}
.count-box{background:var(--soft);padding:10px 14px;border-radius:12px;min-width:72px;box-shadow:inset 0 -6px rgba(255,200,230,0.05)}
.count-box span{display:block;font-weight:700;font-size:18px}
.hint{font-size:0.9rem;color:#8a536f;margin-top:8px}
.match-notice{margin-top:8px;color:#98506f;font-weight:600;opacity:0.95}

/* START BUTTON */
.start-btn{margin-top:12px;display:inline-block;background:linear-gradient(90deg,var(--accent),#ff7aa0);color:#fff;border:none;padding:12px 20px;border-radius:12px;font-weight:700;cursor:pointer;font-size:16px}

/* main stage */
.main-stage{width:100%;max-width:820px;display:flex;justify-content:center;margin-top:18px}
.cake-area{position:relative;width:100%;display:flex;flex-direction:column;align-items:center;min-height:300px}
.cake-card{background:linear-gradient(180deg,#fff,#fff7fb);padding:14px;border-radius:12px;box-shadow:0 10px 28px rgba(200,120,160,0.06);width:100%;max-width:520px;display:flex;flex-direction:column;align-items:center}
#cakeSvg{width:100%;height:auto;display:block}
.cake-text{margin-top:12px;text-align:center}
.cake-text h2{font-family:'Great Vibes',cursive;color:var(--accent);font-size:28px;margin-bottom:6px}
.cake-text p{color:#6b4459}

/* match image */
.match-img{position:fixed;right:18px;bottom:18px;z-index:120;width:86px;height:auto;touch-action:none;cursor:grab;user-select:none}
.match-img:active{cursor:grabbing}
.match-img.hidden{display:none}

/* flames */
.flame{transform-origin:center;animation:flame 360ms infinite}
@keyframes flame{0%{transform:translateY(0) scale(1)}50%{transform:translateY(-1.6px) scale(1.04)}100%{transform:translateY(0) scale(1)}}

/* particle */
.particle{position:fixed;z-index:90;pointer-events:none;border-radius:3px}

/* dialog animation */
.dialog-wrap{position:fixed;inset:0;background:rgba(20,10,20,0.36);display:flex;align-items:center;justify-content:center;z-index:200;padding:18px;opacity:0;transform:translateY(12px);pointer-events:none;transition:opacity 360ms ease, transform 360ms cubic-bezier(.2,.9,.2,1)}
.dialog-wrap.show{opacity:1;transform:translateY(0);pointer-events:auto}
.dialog{background:#fff;border-radius:12px;max-width:520px;width:100%;padding:14px;box-shadow:0 16px 48px rgba(120,20,60,0.12);text-align:center}
.dialog h3{margin-bottom:8px;color:var(--accent)}
.dialog-body{min-height:84px;padding:10px;color:#5c3d4c}
.dialog-controls{display:flex;justify-content:space-between;gap:10px;margin-top:12px}
button.primary{background:linear-gradient(90deg,var(--accent),#ff7aa0);color:#fff;border:none;padding:10px 16px;border-radius:10px;font-weight:600;cursor:pointer}
button.ghost{background:transparent;border:1px solid #e6b6cf;padding:10px 14px;border-radius:10px;cursor:pointer}
.hidden{display:none}

/* final closing state: keep only cake + text */
.final-only .hero, .final-only .main-stage .match-img, .final-only .dialog-wrap {opacity:1}
.final-only .dialog-wrap{display:none}

/* responsive */
@media (max-width:480px){.title{font-size:28px}.match-img{width:66px}.count-box span{font-size:16px}}
  </style>
</head>
<body>
  <div class="page">
    <header class="hero">
      <div class="badge">19 November 2025</div>
      <h1 class="title">Keisya Salsabe <span>(kesaaa)</span></h1>
      <p id="hint" class="hint">Geser korek ke tiap lilin untuk menyalakan, satu per satu.</p>

      <!-- START BUTTON -->
      <button id="startBtn" class="start-btn">Selamat Ulang Tahun</button>

      <div id="matchNotice" class="match-notice"></div>
    </header>

    <main class="main-stage">
      <section id="cakeArea" class="cake-area" aria-hidden="false">
        <div class="cake-card">
          <svg id="cakeSvg" viewBox="0 0 640 360" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <ellipse cx="320" cy="320" rx="220" ry="22" fill="#fff6fb" stroke="#ffe6f2"/>
            <g id="cakeBody">
              <rect x="100" y="140" rx="28" ry="28" width="440" height="140" fill="#ffdfe9" stroke="#ffc9dd"/>
              <rect x="100" y="120" rx="28" ry="28" width="440" height="36" fill="#fff6fb"/>
              <g fill="#ff9fcf">
                <circle cx="180" cy="190" r="7"/>
                <circle cx="240" cy="208" r="7"/>
                <circle cx="300" cy="190" r="7"/>
                <circle cx="360" cy="208" r="7"/>
                <circle cx="420" cy="190" r="7"/>
                <circle cx="480" cy="208" r="7"/>
              </g>
            </g>

            <g id="candles">
              <g class="candle" id="c1" transform="translate(240,100)">
                <rect class="stem" x="-8" y="0" width="16" height="56" rx="4" fill="#fff"/>
                <rect x="-8" y="0" width="16" height="16" rx="4" fill="#ffd6e8"/>
                <rect class="wick" x="-1.5" y="-8" width="3" height="8" fill="#2b2b2b"/>
                <g class="flame hidden" transform="translate(0,-14)">
                  <path d="M0 0 C5 -6, 5 -12, 0 -18 C-5 -12, -5 -6, 0 0 Z" fill="#ffd36b"/>
                  <path d="M0 -6 C2 -9, 2 -12, 0 -14 C-2 -12, -2 -9, 0 -6 Z" fill="#ff8b45"/>
                </g>
              </g>

              <g class="candle" id="c2" transform="translate(320,92)">
                <rect class="stem" x="-8" y="0" width="16" height="64" rx="4" fill="#fff"/>
                <rect x="-8" y="0" width="16" height="16" rx="4" fill="#fff1f7"/>
                <rect class="wick" x="-1.5" y="-8" width="3" height="8" fill="#2b2b2b"/>
                <g class="flame hidden" transform="translate(0,-16)">
                  <path d="M0 0 C5 -6, 5 -12, 0 -18 C-5 -12, -5 -6, 0 0 Z" fill="#ffd36b"/>
                  <path d="M0 -6 C2 -9, 2 -12, 0 -14 C-2 -12, -2 -9, 0 -6 Z" fill="#ff8b45"/>
                </g>
              </g>

              <g class="candle" id="c3" transform="translate(400,100)">
                <rect class="stem" x="-8" y="0" width="16" height="56" rx="4" fill="#fff"/>
                <rect x="-8" y="0" width="16" height="16" rx="4" fill="#ffe6f0"/>
                <rect class="wick" x="-1.5" y="-8" width="3" height="8" fill="#2b2b2b"/>
                <g class="flame hidden" transform="translate(0,-14)">
                  <path d="M0 0 C5 -6, 5 -12, 0 -18 C-5 -12, -5 -6, 0 0 Z" fill="#ffd36b"/>
                  <path d="M0 -6 C2 -9, 2 -12, 0 -14 C-2 -12, -2 -9, 0 -6 Z" fill="#ff8b45"/>
                </g>
              </g>
            </g>
          </svg>

          <div id="cakeText" class="cake-text hidden">
            <h2>Selamat Ulang Tahun, Keisya!</h2>
            <p>Semoga harimu dipenuhi kebahagiaan dan cinta â€” aku sayang kamu ðŸ’–</p>
          </div>
        </div>

        <img id="matchImg" class="match-img" alt="korek" draggable="false" />
      </section>
    </main>

    <div id="dialogWrap" class="dialog-wrap hidden" role="dialog" aria-modal="true" aria-labelledby="dialogTitle">
      <div class="dialog">
        <h3 id="dialogTitle">Pesan untuk Keisya</h3>
        <div id="dialogBody" class="dialog-body" tabindex="0"></div>
        <div class="dialog-controls">
          <button id="backBtn" class="ghost">Back</button>
          <button id="nextBtn" class="primary">Next</button>
        </div>
      </div>
    </div>

    <footer class="footer">Â© 2025 Dibuat khusus untuk Keisya</footer>

    <audio id="strikeAudio" src="https://cdn.pixabay.com/download/audio/2021/08/04/audio_f3d9c2c3e5.mp3?filename=match-strike-5660.mp3" preload="auto"></audio>
    <audio id="birthdayAudio" src="https://cdn.pixabay.com/download/audio/2023/01/26/audio_7c631aef1d.mp3?filename=happy-birthday-piano-music-135128.mp3" preload="auto"></audio>
  </div>

  <script>
(function(){
  // ================================
  // CONFIG
  // ================================
  // FIX: format tanggal aman untuk semua browser
  const BIRTHDAY = new Date(2025, 11, 19, 0, 0, 0);

  const cakeArea = document.getElementById('cakeArea');
  const matchImg = document.getElementById('matchImg');
  const strikeAudio = document.getElementById('strikeAudio');
  const birthdayAudio = document.getElementById('birthdayAudio');
  const cakeText = document.getElementById('cakeText');
  const hint = document.getElementById('hint');
  const matchNotice = document.getElementById('matchNotice');
  const startBtn = document.getElementById('startBtn');

  const LIGHTER_OFF = 'korek.png';
  const LIGHTER_ON  = 'korekapi.png';

  const messages = [
    "Selamat ulang tahun, sayangggg ðŸ’–.",
    "hmmmmmmm anjayyyy kesa ultah",
    "heheheheeee. maaf ya yang kemaren kemaren sering ge kamu nangis dan betmut",
    "aku seneng kamu gelem crito, gelm jujur.",
    "aku bahagia ketemu kesa seng centill eram",
    "kamu sayang aku gak?",
    "sayangkan?? kudu sayanggðŸ’•",
    "ahhhh",
    "oiyaaa hari ini tenggal berapa?",
    "19 november 2025 kan",
    "Harini hari special bangetttttttttt",
    "hari yang dimana kesa di lahirkan di tahun 2005",
    "19 november 2025 umur keisya 20",
    "hari ini hari yang sakral..",
    "Semoga keinginan mu semua ke keturutan..",
    "... di jauhkan dari orang orang jahat",
    "... jadilah wanita kuat, kuat mental kuat fisik",
    "... bisa nyenengin orangtua",
    "jadikan contoh yang baik untuk adik adikmu keponakanmu",
    "Maaf yaa belum bisa seng mok karepne tapi aku usahakan selalu ada di sampingmu, karana ingin nenujukan kalok aku sayang kesa",
    "Selebihnya..  aku berterimaksih uwes enek ng hidupku\nAku bersukur iso bertemu kamu kamu cantik, kamu manis, kamu crewet, kamu lucu selebih lebihnyaaaa\nwchahchhchchchhcc",
    "Lingguh sek ojo kesusu di pencet next....",
    "Wis lingguh?..",
    "...",
    "Ø¨ÙØ³Ù’Ù…Ù Ø§Ù„Ù„Ù‘Ù°Ù‡Ù Ø§Ù„Ø±ÙŽÙ‘Ø­Ù’Ù…Ù°Ù†Ù Ø§Ù„Ø±ÙŽÙ‘Ø­ÙÙŠÙ’Ù…Ù",
    "Ø§ÙŽÙ„Ù„Ù‘Ù°Ù‡ÙÙ…Ù‘ÙŽ Ø£ÙŽØ·ÙÙ„Ù’ Ø¹ÙÙ…ÙØ±ÙŽÙ‡ÙŽØ§ ÙÙÙŠ Ø·ÙŽØ§Ø¹ÙŽØªÙÙƒÙŽØŒ ÙˆÙŽØ¨ÙŽØ§Ø±ÙÙƒÙ’ Ù„ÙŽÙ‡ÙŽØ§ ÙÙÙŠ Ø±ÙØ²Ù’Ù‚ÙÙ‡ÙŽØ§ØŒ ÙˆÙŽØ§Ø¬Ù’Ø¹ÙŽÙ„Ù’Ù‡ÙŽØ§ Ù…ÙÙ†Ù’ Ø¹ÙØ¨ÙŽØ§Ø¯ÙÙƒÙŽ Ø§Ù„ØµÙ‘ÙŽØ§Ù„ÙØ­ÙÙŠÙ†ÙŽØŒ ÙˆÙŽØ§Ø­Ù’ÙÙŽØ¸Ù’Ù‡ÙŽØ§ Ø¨ÙØ­ÙÙÙ’Ø¸ÙÙƒÙŽ Ø§Ù„Ø¯Ù‘ÙŽØ§Ø¦ÙÙ…ÙØŒ ÙˆÙŽØ§Ø±Ù’Ø²ÙÙ‚Ù’Ù‡ÙŽØ§ Ø³ÙŽØ¹ÙŽØ§Ø¯ÙŽØ©Ù‹ Ø¯ÙÙ†Ù’ÙŠÙŽØ§ ÙˆÙŽØ§Ù„Ù’Ø¢Ø®ÙØ±ÙŽØ©ÙŽ.                      AllÄhumma aá¹­il â€˜umrahÄ fÄ« á¹­Äâ€˜atik, wa bÄrik lahÄ fÄ« rizqihÄ, wajâ€˜alhÄ min â€˜ibÄdikas á¹£Äliá¸¥Ä«n, waá¸¥faáº“hÄ biá¸¥ifáº“ikad dÄâ€™im, warzuqâ€™hÄ saâ€˜Ädata d-dunyÄ wal-Äkhirah.",
    "Ya Allah, panjangkanlah umur Keisya dalam ketaatan kepada-Mu, berkahilah rezekinya, jadikanlah dia termasuk hamba-Mu yang salehah, lindungilah dengan penjagaan-Mu yang tiada henti, dan anugerahkanlah kebahagiaan dunia serta akhirat kepadanya.",
    "Al-FÄtiá¸¥ah.."
  ];

  const dialogWrap = document.getElementById('dialogWrap');
  const dialogBody = document.getElementById('dialogBody');
  const backBtn = document.getElementById('backBtn');
  const nextBtn = document.getElementById('nextBtn');
  let dialogIndex = 0;

  // Candle data
  const candleIds = ['c1','c2','c3'];
  const candles = candleIds.map(id => {
    const g = document.getElementById(id);
    return { id, group: g, wick: g?.querySelector('.wick'), flame: g?.querySelector('.flame'), lit: false };
  });

  function confetti(n=18){
    const colors = ['#ffb3c6','#ffd6e8','#ff9fcf','#ffc0cb','#fff1f7'];
    for(let i=0;i<n;i++){
      const el = document.createElement('div');
      el.className = 'particle';
      const size = 6 + Math.random()*10;
      el.style.width = size+'px';
      el.style.height = size+'px';
      el.style.left = (10 + Math.random()*80) + '%';
      el.style.bottom = (10 + Math.random()*10) + '%';
      el.style.background = colors[Math.floor(Math.random()*colors.length)];
      document.body.appendChild(el);
      el.animate(
        [
          {transform:'translateY(0) rotate(0)', opacity:1},
          {transform:'translateY(-90vh) rotate(540deg)', opacity:0}
        ],
        { duration: 1400 + Math.random()*1200, easing:'ease-out', fill:'forwards' }
      );
      setTimeout(()=>el.remove(),3000);
    }
  }

  matchImg.src = LIGHTER_OFF;
  matchImg.alt = 'korek';

  function placeMatchDefault(){
    matchImg.style.left = 'auto';
    matchImg.style.top = 'auto';
    matchImg.style.right = '18px';
    matchImg.style.bottom = '18px';
    matchImg.style.position = 'fixed';
  }

  function strikeOnce(){
    try{ strikeAudio.currentTime = 0; strikeAudio.play().catch(()=>{}); }catch(e){}
    const tip = { x: window.innerWidth/2, y: window.innerHeight/2 };
    for(let i=0;i<6;i++){
      const s = document.createElement('div');
      s.className = 'particle';
      s.style.width='6px'; s.style.height='6px';
      s.style.left = (tip.x + (Math.random()-0.5)*40) + 'px';
      s.style.top = (tip.y + (Math.random()-0.5)*24) + 'px';
      s.style.background = ['#ffc36a','#ff8b3b'][Math.floor(Math.random()*2)];
      document.body.appendChild(s);
      s.animate(
        [ {transform:'translateY(0)', opacity:1}, {transform:'translateY(-40px)', opacity:0} ],
        {duration:400 + Math.random()*300, easing:'ease-out', fill:'forwards'}
      );
      setTimeout(()=>s.remove(),800);
    }
  }

  function lightCandle(c){
    if(c.lit) return;
    c.lit = true;
    c.flame?.classList.remove('hidden');
    confetti(6);
  }

  function onAllLit(){
    matchImg.style.transition = 'opacity 700ms ease';
    matchImg.style.opacity = '0';
    setTimeout(()=> matchImg.classList.add('hidden'), 800);

    try{ birthdayAudio.currentTime = 0; birthdayAudio.play().catch(()=>{}); }catch(e){}
    cakeText.classList.remove('hidden');

    setTimeout(()=> openDialog(), 800);
  }

  // Start sequence: lights all candles and opens dialog
  function startBirthdaySequence(){
    // hide start button
    startBtn.disabled = true;
    startBtn.style.opacity = '0.6';

    // quick UX: update hint
    hint.textContent = 'Selamat! Semua lilin menyala.';

    // simulate strike + play strike sound
    strikeOnce();

    // light all candles
    candles.forEach(c => {
      lightCandle(c);
    });

    // confetti + play music
    confetti(36);
    try{ birthdayAudio.currentTime = 0; birthdayAudio.play().catch(()=>{}); }catch(e){}

    // show cake text and open dialog shortly after
    cakeText.classList.remove('hidden');

    // hide match (optional)
    matchImg.classList.add('hidden');

    setTimeout(()=>{
      openDialog();
    }, 700);
  }

  // DIALOG LOGIC
  function openDialog(){
    dialogIndex = 0;
    dialogWrap.classList.remove('hidden');
    setTimeout(()=> dialogWrap.classList.add('show'), 10);
    renderDialog();
  }
  function closeDialog(){
    dialogWrap.classList.remove('show');
    setTimeout(()=> dialogWrap.classList.add('hidden'), 360);
    document.body.classList.add('final-only');
    confetti(40);
  }
  function renderDialog(){
    dialogBody.textContent = messages[dialogIndex] || '';
    backBtn.disabled = dialogIndex === 0;
    nextBtn.textContent = (dialogIndex === messages.length - 1) ? 'Selesai' : 'Next';
  }

  backBtn?.addEventListener('click', ()=>{ if(dialogIndex > 0){ dialogIndex--; renderDialog(); } });
  nextBtn?.addEventListener('click', ()=>{ if(dialogIndex < messages.length - 1){ dialogIndex++; renderDialog(); } else { closeDialog(); } });

  // Start button
  startBtn.addEventListener('click', ()=>{
    startBirthdaySequence();
  });

  // If page loaded after birthday -> ensure UI reveals as before
  (function immediate(){ if(new Date() >= BIRTHDAY){ /* keep start button but also auto-start */ startBirthdaySequence(); }} )();

  // Make sure matchImg placed
  placeMatchDefault();
})();
  </script>
</body>
</html>
